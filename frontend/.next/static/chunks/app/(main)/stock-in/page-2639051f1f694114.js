(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[490],{4616:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5516:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var s=a(5155),r=a(2115),d=a(7108),i=a(4616),l=a(2525),c=a(5695),n=a(6769),o=a(5231);function x(){let e=(0,c.useRouter)(),[t,a]=(0,r.useState)(""),[x,h]=(0,r.useState)([]),[p,m]=(0,r.useState)(!1),[u,g]=(0,r.useState)(null),[y,b]=(0,r.useState)(!1),[f,j]=(0,r.useState)(""),[w,N]=(0,r.useState)("info"),v=async e=>{if(e.preventDefault(),t.trim()){m(!0),g(null);try{let e=await fetch("".concat("http://localhost:5001","/products/search?barcode=").concat(encodeURIComponent(t.trim())),{credentials:"include"});if(!e.ok)throw Error("Failed to search product");let s=await e.json();if(!s.product){j("ไม่พบสินค้านี้ในระบบ โปรดเพิ่มสินค้าใหม่ก่อน"),N("warning"),b(!0),a("");return}if(x.find(e=>e.product.id===s.product.id)){j("สินค้านี้มีอยู่ในรายการแล้ว"),N("info"),b(!0),a("");return}let r={id:Date.now().toString(),product:s.product,addDate:new Date,quantity:1};h(e=>[...e,r]),a(""),g(null)}catch(e){g((null==e?void 0:e.message)||"เกิดข้อผิดพลาดในการค้นหาสินค้า")}finally{m(!1)}}},k=async()=>{if(0!==x.length){m(!0),g(null);try{for(let e of x){let t=await fetch("".concat("http://localhost:5001","/products/").concat(e.product.id,"/stock-in"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({quantity:e.quantity,costPrice:e.product.costPrice,notes:"Stock In - ".concat(new Date().toLocaleDateString("th-TH"))})});if(!t.ok){let a=await t.json();throw Error(a.message||"Failed to update stock for ".concat(e.product.name))}}h([]),g(null),j("เพิ่มสต็อกสินค้าเรียบร้อยแล้ว"),N("success"),b(!0)}catch(e){g((null==e?void 0:e.message)||"เกิดข้อผิดพลาดในการเพิ่มสต็อก")}finally{m(!1)}}};return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 p-6",children:[(0,s.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("div",{className:"w-12 h-12 bg-orange-100 rounded-xl flex items-center justify-center",children:(0,s.jsx)(d.A,{className:"w-6 h-6 text-orange-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"เพิ่มสต็อกสินค้า"}),(0,s.jsx)("p",{className:"text-gray-600",children:"สแกนหรือกรอก Barcode เพื่อเพิ่มสินค้าเข้าระบบ"})]})]}),(0,s.jsxs)("button",{onClick:()=>e.push("/products"),className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors flex items-center gap-2",children:[(0,s.jsx)(i.A,{className:"w-4 h-4"}),"จัดการสินค้า"]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:(0,s.jsxs)("form",{onSubmit:v,className:"max-w-md",children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Barcode Number"}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("input",{type:"text",value:t,onChange:e=>a(e.target.value),placeholder:"สแกนหรือกรอก Barcode...",className:"flex-1 px-4 py-3 border text-gray-900 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all",disabled:p}),(0,s.jsx)("button",{type:"submit",disabled:p||!t.trim(),className:"px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:p?"กำลังค้นหา...":"ค้นหา"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"กด Enter หรือคลิกปุ่มค้นหาเพื่อค้นหาสินค้า"})]})}),u&&(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)(n.A,{severity:"error",variant:"filled",children:u})}),x.length>0&&(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,s.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["รายการสินค้าที่จะเพิ่มสต็อก (",x.length," รายการ)"]})}),(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Barcode"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SKU"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ชื่อสินค้า"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"วันที่เพิ่ม"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"จำนวน"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"การดำเนินการ"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.product.barcode||"-"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.product.sku}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.product.name}),e.product.description&&(0,s.jsx)("div",{className:"text-gray-500 text-xs truncate max-w-xs",children:e.product.description})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.addDate.toLocaleDateString("th-TH")}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,s.jsx)("input",{type:"number",min:"1",value:e.quantity,onChange:t=>{var a,s;return a=e.id,s=Number(t.target.value),void h(e=>e.map(e=>e.id===a?{...e,quantity:Math.max(1,s)}:e))},className:"w-20 px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,s.jsx)("button",{onClick:()=>{var t;return t=e.id,void h(e=>e.filter(e=>e.id!==t))},className:"text-red-600 hover:text-red-900 transition-colors",title:"ลบรายการ",children:(0,s.jsx)(l.A,{className:"w-4 h-4"})})})]},e.id))})]})}),(0,s.jsx)("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50",children:(0,s.jsx)("button",{onClick:k,disabled:p,className:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:p?"กำลังเพิ่มสต็อก...":"เพิ่มสต็อกสินค้า"})})]}),0===x.length&&!p&&(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[(0,s.jsx)(d.A,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ยังไม่มีรายการสินค้า"}),(0,s.jsx)("p",{className:"text-gray-500",children:"กรอก Barcode เพื่อเริ่มเพิ่มสินค้าเข้าระบบ"})]})]}),(0,s.jsx)(o.A,{open:y,autoHideDuration:3e3,onClose:()=>b(!1),anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,s.jsx)(n.A,{onClose:()=>b(!1),severity:w,variant:"filled",sx:{width:"100%"},children:f})})]})}},6500:(e,t,a)=>{Promise.resolve().then(a.bind(a,5516))},7108:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])}},e=>{e.O(0,[81,441,964,358],()=>e(e.s=6500)),_N_E=e.O()}]);