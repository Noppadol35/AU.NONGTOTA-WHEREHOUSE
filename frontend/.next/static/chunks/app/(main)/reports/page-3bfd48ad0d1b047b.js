(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[307],{1243:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(9946).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},2713:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(9946).A)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},3109:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(9946).A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},4416:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(9946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},5339:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(9946).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},5695:(e,t,s)=>{"use strict";var l=s(8999);s.o(l,"useRouter")&&s.d(t,{useRouter:function(){return l.useRouter}}),s.o(l,"useSearchParams")&&s.d(t,{useSearchParams:function(){return l.useSearchParams}})},5868:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(9946).A)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},7108:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(9946).A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},7434:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(9946).A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},7580:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(9946).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},7587:(e,t,s)=>{Promise.resolve().then(s.bind(s,9689))},7930:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(9946).A)("car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]])},8313:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(9946).A)("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]])},9397:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(9946).A)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},9689:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>W});var l=s(5155),a=s(2115),r=s(5695);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter(Boolean).join(" ")}let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("div",{ref:t,className:n("rounded-lg border border-gray-200 bg-white text-gray-900 shadow-sm",s),...a})});c.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("div",{ref:t,className:n("flex flex-col space-y-1.5 p-6",s),...a})});i.displayName="CardHeader";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("h3",{ref:t,className:n("text-2xl font-semibold leading-none tracking-tight",s),...a})});d.displayName="CardTitle";let x=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("p",{ref:t,className:n("text-sm text-gray-600",s),...a})});x.displayName="CardDescription";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("div",{ref:t,className:n("p-6 pt-0",s),...a})});o.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,l.jsx)("div",{ref:t,className:n("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter";let m=e=>{let{value:t,onValueChange:s,children:r,className:c}=e;return(0,l.jsx)("div",{className:n("w-full",c),children:a.Children.map(r,e=>a.isValidElement(e)?a.cloneElement(e,{value:t,onValueChange:s}):e)})},h=e=>{let{children:t,className:s}=e;return(0,l.jsx)("div",{className:n("inline-flex h-10 items-center justify-center rounded-md bg-gray-100 p-1 text-gray-600",s),children:t})},u=e=>{let{value:t,children:s,className:r,onClick:c}=e,i=a.useContext(p);if(!i)throw Error("TabsTrigger must be used within Tabs");let d=i.value===t;return(0,l.jsx)("button",{onClick:()=>{i.onValueChange(t),null==c||c()},className:n("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",d?"bg-white text-gray-900 shadow-sm border border-gray-200":"hover:bg-gray-200 text-gray-700",r),children:s})},j=e=>{let{value:t,children:s,className:r}=e,c=a.useContext(p);if(!c)throw Error("TabsContent must be used within Tabs");return c.value!==t?null:(0,l.jsx)("div",{className:n("mt-2 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",r),children:s})},p=a.createContext(null),g=e=>{let{value:t,onValueChange:s,children:a,className:r}=e;return(0,l.jsx)(p.Provider,{value:{value:t,onValueChange:s},children:(0,l.jsx)(m,{value:t,onValueChange:s,className:r,children:a})})};var f=s(1243),y=s(7434),N=s(5868),b=s(9397),v=s(7580),w=s(7108),A=s(3109),S=s(2713);let k="http://localhost:5001";class C{async fetchWithAuth(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=await fetch("".concat(k).concat(e),{...t,credentials:"include",headers:{"Content-Type":"application/json",...t.headers}});if(!s.ok){if(401===s.status)throw Error("Authentication required");throw Error("HTTP error! status: ".concat(s.status))}return s.json()}async getLowStockReport(){return this.fetchWithAuth("/reports/low-stock")}async getInventoryValueReport(){return this.fetchWithAuth("/reports/inventory-value")}async getTopMovingItemsReport(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"month";return this.fetchWithAuth("/reports/top-moving?timeRange=".concat(e))}async getCustomerHistoryReport(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";return this.fetchWithAuth("/reports/customer-history?filter=".concat(e))}async getReportsSummary(){return this.fetchWithAuth("/reports/summary")}async getCustomerJobs(e){try{let t=await this.fetchWithAuth("/reports/customer-jobs/".concat(e));return await Promise.all(t.map(async e=>{try{let r=await fetch("".concat(k,"/job-orders/").concat(e.id,"/bill"),{credentials:"include"});if(r.ok){var t,s,l,a;let n=await r.json();return{...e,subtotal:(null==(t=n.bill)?void 0:t.subtotal)||0,laborCost:(null==(s=n.bill)?void 0:s.laborCost)||0,vatAmount:(null==(l=n.bill)?void 0:l.vatAmount)||0,grandTotal:(null==(a=n.bill)?void 0:a.grandTotal)||e.totalAmount}}}catch(t){console.error("Error fetching billing for job ".concat(e.id,":"),t)}return e}))}catch(e){throw console.error("Error fetching customer jobs:",e),e}}}let L=new C;var M=s(5339),R=s(9946);let E=(0,R.A)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]);function P(){var e,t,s;let[r,n]=(0,a.useState)([]),[m,h]=(0,a.useState)(null),[u,j]=(0,a.useState)(!0),[p,g]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{try{g(null);let e=await L.getLowStockReport();n(e.products),h(e.summary)}catch(e){console.error("Failed to fetch low stock report:",e),g(e.message||"Failed to fetch low stock report")}finally{j(!1)}})()},[]);let y=(e,t)=>{let s=e/t*100;return s<=30?"critical":s<=50?"warning":"low"};return u?(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):p?(0,l.jsxs)("div",{className:"text-center text-red-600 py-8",children:[(0,l.jsxs)("p",{children:["เกิดข้อผิดพลาด: ",p]}),(0,l.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"ลองใหม่"})]}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)(c,{className:"border-l-4 border-l-red-500",children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium text-red-600",children:"สินค้า Critical"}),(0,l.jsx)(f.A,{className:"h-4 w-4 text-red-500"})]}),(0,l.jsxs)(o,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-red-600",children:(null==m||null==(e=m.critical)?void 0:e.toLocaleString())||"0"}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"≤ 30% ของ min stock"})]})]}),(0,l.jsxs)(c,{className:"border-l-4 border-l-yellow-500",children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium text-yellow-600",children:"สินค้า Warning"}),(0,l.jsx)(M.A,{className:"h-4 w-4 text-yellow-500"})]}),(0,l.jsxs)(o,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:(null==m||null==(t=m.warning)?void 0:t.toLocaleString())||"0"}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"31-50% ของ min stock"})]})]}),(0,l.jsxs)(c,{className:"border-l-4 border-l-blue-500",children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium text-blue-600",children:"สินค้าทั้งหมด"}),(0,l.jsx)(w.A,{className:"h-4 w-4 text-blue-500"})]}),(0,l.jsxs)(o,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:(null==m||null==(s=m.total)?void 0:s.toLocaleString())||"0"}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"รายการที่ใกล้หมด"})]})]})]}),(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{children:[(0,l.jsxs)(d,{className:"flex items-center space-x-2",children:[(0,l.jsx)(f.A,{className:"w-5 h-5"}),(0,l.jsx)("span",{children:"รายการสินค้าใกล้หมด"})]}),(0,l.jsx)(x,{children:"สินค้าที่มีจำนวนคงเหลือต่ำกว่าหรือเท่ากับ 10 ชิ้น"})]}),(0,l.jsx)(o,{className:"p-0",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-gray-50 border-b border-gray-200",children:[(0,l.jsx)("th",{className:"text-left px-6 py-4 font-semibold text-gray-700",children:"สินค้า"}),(0,l.jsx)("th",{className:"text-left px-6 py-4 font-semibold text-gray-700",children:"SKU"}),(0,l.jsx)("th",{className:"text-left px-6 py-4 font-semibold text-gray-700",children:"หมวดหมู่"}),(0,l.jsx)("th",{className:"text-left px-6 py-4 font-semibold text-gray-700",children:"สาขา"}),(0,l.jsx)("th",{className:"text-center px-6 py-4 font-semibold text-gray-700",children:"คงเหลือ"}),(0,l.jsx)("th",{className:"text-center px-6 py-4 font-semibold text-gray-700",children:"ขั้นต่ำ"}),(0,l.jsx)("th",{className:"text-center px-6 py-4 font-semibold text-gray-700",children:"สถานะ"}),(0,l.jsx)("th",{className:"text-center px-6 py-4 font-semibold text-gray-700",children:"อัพเดทล่าสุด"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-gray-100",children:r.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-red-50 transition-all duration-200",children:[(0,l.jsx)("td",{className:"p-3 font-medium",children:e.name}),(0,l.jsx)("td",{className:"p-3",children:(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e.sku})}),(0,l.jsx)("td",{className:"p-3",children:e.category}),(0,l.jsx)("td",{className:"p-3",children:e.branch}),(0,l.jsx)("td",{className:"p-3 text-right",children:(0,l.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[((e,t)=>{switch(y(e,t)){case"critical":return(0,l.jsx)(f.A,{className:"w-4 h-4 text-red-500"});case"warning":return(0,l.jsx)(M.A,{className:"w-4 h-4 text-yellow-500"});case"low":return(0,l.jsx)(E,{className:"w-4 h-4 text-orange-500"});default:return(0,l.jsx)(w.A,{className:"w-4 h-4 text-gray-500"})}})(e.stockQuantity,e.minStockLevel),(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e.stockQuantity<=5?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"),children:e.stockQuantity.toLocaleString()})]})}),(0,l.jsx)("td",{className:"p-3 text-right",children:(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e.minStockLevel.toLocaleString()})}),(0,l.jsx)("td",{className:"p-3 text-center",children:((e,t)=>{switch(y(e,t)){case"critical":return(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Critical"});case"warning":return(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Warning"});case"low":return(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Low"});default:return(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Normal"})}})(e.stockQuantity,e.minStockLevel)}),(0,l.jsx)("td",{className:"p-3 text-sm text-gray-500",children:e.lastUpdated})]},e.id))})]})})})]})]})}function T(){var e,t,s,r;let[n,m]=(0,a.useState)([]),[h,u]=(0,a.useState)(null),[j,p]=(0,a.useState)(!0),[g,f]=(0,a.useState)(null);return((0,a.useEffect)(()=>{(async()=>{try{f(null);let e=await L.getInventoryValueReport();m(e.items),u(e.summary)}catch(e){console.error("Failed to fetch inventory value report:",e),f(e.message||"Failed to fetch inventory value report")}finally{p(!1)}})()},[]),j)?(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):g?(0,l.jsxs)("div",{className:"text-center text-red-600 py-8",children:[(0,l.jsxs)("p",{children:["เกิดข้อผิดพลาด: ",g]}),(0,l.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"ลองใหม่"})]}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium",children:"มูลค่ารวม"}),(0,l.jsx)(N.A,{className:"h-4 w-4 text-green-600"})]}),(0,l.jsxs)(o,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["฿",(null==h||null==(e=h.totalValue)?void 0:e.toLocaleString())||"0"]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"รวมมูลค่าสินค้าทั้งหมด"})]})]}),(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium",children:"จำนวนรายการ"}),(0,l.jsx)(w.A,{className:"h-4 w-4 text-blue-600"})]}),(0,l.jsxs)(o,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:(null==h||null==(t=h.totalItems)?void 0:t.toLocaleString())||"0"}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"ชิ้น"})]})]}),(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium",children:"สินค้าทั้งหมด"}),(0,l.jsx)(w.A,{className:"h-4 w-4 text-purple-600"})]}),(0,l.jsxs)(o,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:(null==h||null==(s=h.totalProducts)?void 0:s.toLocaleString())||"0"}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"รายการ"})]})]}),(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium",children:"มูลค่าเฉลี่ย"}),(0,l.jsx)(A.A,{className:"h-4 w-4 text-orange-600"})]}),(0,l.jsxs)(o,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold text-orange-600",children:["฿",(null==h||null==(r=h.averageValue)?void 0:r.toLocaleString())||"0"]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"ต่อรายการ"})]})]})]}),(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{children:[(0,l.jsxs)(d,{className:"flex items-center space-x-2",children:[(0,l.jsx)(w.A,{className:"w-5 h-5"}),(0,l.jsx)("span",{children:"รายการสินค้า"})]}),(0,l.jsx)(x,{children:"รายการสินค้าทั้งหมดพร้อมมูลค่า"})]}),(0,l.jsx)(o,{className:"p-0",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-gray-50 border-b border-gray-200",children:[(0,l.jsx)("th",{className:"text-left px-6 py-4 font-semibold text-gray-700",children:"สินค้า"}),(0,l.jsx)("th",{className:"text-left px-6 py-4 font-semibold text-gray-700",children:"SKU"}),(0,l.jsx)("th",{className:"text-left px-6 py-4 font-semibold text-gray-700",children:"หมวดหมู่"}),(0,l.jsx)("th",{className:"text-left px-6 py-4 font-semibold text-gray-700",children:"สาขา"}),(0,l.jsx)("th",{className:"text-center px-6 py-4 font-semibold text-gray-700",children:"คงเหลือ"}),(0,l.jsx)("th",{className:"text-right px-6 py-4 font-semibold text-gray-700",children:"ต้นทุน/หน่วย"}),(0,l.jsx)("th",{className:"text-right px-6 py-4 font-semibold text-gray-700",children:"มูลค่ารวม"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-gray-100",children:n.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-green-50 transition-all duration-200",children:[(0,l.jsx)("td",{className:"p-3 font-medium",children:e.name}),(0,l.jsx)("td",{className:"p-3",children:(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e.sku})}),(0,l.jsx)("td",{className:"p-3",children:e.category}),(0,l.jsx)("td",{className:"p-3",children:e.branch}),(0,l.jsx)("td",{className:"p-3 text-right",children:(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e.stockQuantity<=10?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"),children:e.stockQuantity.toLocaleString()})}),(0,l.jsxs)("td",{className:"p-3 text-right",children:["฿",e.unitCost.toLocaleString()]}),(0,l.jsxs)("td",{className:"p-3 text-right font-medium text-green-600",children:["฿",e.totalValue.toLocaleString()]})]},e.id))})]})})})]})]})}function V(){var e,t,s,r;let[n,m]=(0,a.useState)([]),[h,u]=(0,a.useState)(null),[j,p]=(0,a.useState)("month"),[g,f]=(0,a.useState)(!0),[y,b]=(0,a.useState)(null);return((0,a.useEffect)(()=>{(async()=>{try{b(null),f(!0);let e=await L.getTopMovingItemsReport(j);m(e.items),u(e.summary)}catch(e){console.error("Failed to fetch top moving items report:",e),b(e.message||"Failed to fetch top moving items report")}finally{f(!1)}})()},[j]),g)?(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):y?(0,l.jsxs)("div",{className:"text-center text-red-600 py-8",children:[(0,l.jsxs)("p",{children:["เกิดข้อผิดพลาด: ",y]}),(0,l.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"ลองใหม่"})]}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"สินค้าขายดี"}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["สินค้าที่ขายได้มากที่สุดใน",(e=>{switch(e){case"week":return"สัปดาห์นี้";case"month":default:return"เดือนนี้";case"quarter":return"ไตรมาสนี้"}})(j)]})]}),(0,l.jsxs)("select",{value:j,onChange:e=>{p(e.target.value)},className:"px-3 py-2 border rounded-md text-sm",children:[(0,l.jsx)("option",{value:"week",children:"สัปดาห์นี้"}),(0,l.jsx)("option",{value:"month",children:"เดือนนี้"}),(0,l.jsx)("option",{value:"quarter",children:"ไตรมาสนี้"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium",children:"รายได้รวม"}),(0,l.jsx)(N.A,{className:"h-4 w-4 text-green-600"})]}),(0,l.jsxs)(o,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["฿",(null==h||null==(e=h.totalRevenue)?void 0:e.toLocaleString())||"0"]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"รายได้รวม"})]})]}),(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium",children:"จำนวนขาย"}),(0,l.jsx)(w.A,{className:"h-4 w-4 text-blue-600"})]}),(0,l.jsxs)(o,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:(null==h||null==(t=h.totalSold)?void 0:t.toLocaleString())||"0"}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"ชิ้น"})]})]}),(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium",children:"สินค้าขายดี"}),(0,l.jsx)(A.A,{className:"h-4 w-4 text-purple-600"})]}),(0,l.jsxs)(o,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:(null==h||null==(s=h.totalProducts)?void 0:s.toLocaleString())||"0"}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"รายการ"})]})]}),(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium",children:"รายได้เฉลี่ย"}),(0,l.jsx)(S.A,{className:"h-4 w-4 text-orange-600"})]}),(0,l.jsxs)(o,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold text-orange-600",children:["฿",(null==h||null==(r=h.averageRevenue)?void 0:r.toLocaleString())||"0"]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"ต่อรายการ"})]})]})]}),(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{children:[(0,l.jsxs)(d,{className:"flex items-center space-x-2",children:[(0,l.jsx)(A.A,{className:"w-5 h-5"}),(0,l.jsx)("span",{children:"สินค้าขายดี Top 20"})]}),(0,l.jsx)(x,{children:"สินค้าที่ขายได้มากที่สุดเรียงตามจำนวนการขาย"})]}),(0,l.jsx)(o,{className:"p-0",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-gray-50 border-b border-gray-200",children:[(0,l.jsx)("th",{className:"text-left px-6 py-4 font-semibold text-gray-700",children:"อันดับ"}),(0,l.jsx)("th",{className:"text-left px-6 py-4 font-semibold text-gray-700",children:"สินค้า"}),(0,l.jsx)("th",{className:"text-left px-6 py-4 font-semibold text-gray-700",children:"SKU"}),(0,l.jsx)("th",{className:"text-left px-6 py-4 font-semibold text-gray-700",children:"หมวดหมู่"}),(0,l.jsx)("th",{className:"text-center px-6 py-4 font-semibold text-gray-700",children:"จำนวนขาย"}),(0,l.jsx)("th",{className:"text-right px-6 py-4 font-semibold text-gray-700",children:"ราคาเฉลี่ย"}),(0,l.jsx)("th",{className:"text-right px-6 py-4 font-semibold text-gray-700",children:"รายได้"}),(0,l.jsx)("th",{className:"text-center px-6 py-4 font-semibold text-gray-700",children:"ขายล่าสุด"}),(0,l.jsx)("th",{className:"text-center px-6 py-4 font-semibold text-gray-700",children:"แนวโน้ม"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-gray-100",children:n.slice(0,20).map((e,t)=>(0,l.jsxs)("tr",{className:"hover:bg-blue-50 transition-all duration-200",children:[(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold ".concat(t<3?"bg-gradient-to-r from-yellow-400 to-orange-400 text-white":t<10?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-700"),children:["#",t+1]})}),(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsx)("div",{className:"font-semibold text-gray-900",children:e.name})}),(0,l.jsx)("td",{className:"p-3",children:(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e.sku})}),(0,l.jsx)("td",{className:"p-3",children:e.category}),(0,l.jsx)("td",{className:"p-3 text-right",children:(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e.totalSold.toLocaleString()})}),(0,l.jsxs)("td",{className:"p-3 text-right",children:["฿",e.avgPrice.toLocaleString()]}),(0,l.jsxs)("td",{className:"p-3 text-right font-medium text-green-600",children:["฿",e.revenue.toLocaleString()]}),(0,l.jsx)("td",{className:"p-3 text-right text-sm text-gray-500",children:e.lastSold}),(0,l.jsx)("td",{className:"p-3 text-center",children:(0,l.jsxs)("span",{className:"inline-flex items-center space-x-1 px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("up"===e.trend?"bg-green-100 text-green-800":"down"===e.trend?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:[(0,l.jsx)(A.A,{className:"w-3 h-3 ".concat("down"===e.trend?"rotate-180":"")}),(0,l.jsx)("span",{children:"up"===e.trend?"ขึ้น":"down"===e.trend?"ลง":"คงที่"})]})})]},"".concat(e.id,"-").concat(t)))})]})})})]})]})}let q=(0,R.A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);var H=s(4416),I=s(7930),F=s(8313);function J(){var e,t,s,r;let[n,m]=(0,a.useState)([]),[h,u]=(0,a.useState)(null),[j,p]=(0,a.useState)("all"),[g,f]=(0,a.useState)(!0),[b,A]=(0,a.useState)(null),[S,k]=(0,a.useState)(null),[C,M]=(0,a.useState)(!1),[R,E]=(0,a.useState)([]);(0,a.useEffect)(()=>{(async()=>{try{A(null),f(!0);let e=await L.getCustomerHistoryReport(j);m(e.customers),u(e.summary)}catch(e){console.error("Failed to fetch customer history report:",e),A(e.message||"Failed to fetch customer history report")}finally{f(!1)}})()},[j]);let P=async e=>{if(k(e),M(!0),0===e.totalJobs)return void E([]);try{let t=await L.getCustomerJobs(e.id);E(t),console.log("\uD83D\uDD0D ดึงข้อมูลงานของลูกค้า ".concat(e.customerName,": ").concat(t.length," งาน"))}catch(t){console.error("Failed to fetch customer jobs:",t),E([{id:1,jobNumber:"JO-".concat(e.id.toString().padStart(4,"0"),"-001"),date:e.lastVisit,serviceType:"ไม่สามารถโหลดข้อมูลได้",totalAmount:Math.round(e.totalSpent/e.totalJobs),status:"completed",items:[{productName:"ข้อมูลไม่พร้อมใช้งาน",qty:1,unitPrice:0,totalPrice:0}],notes:"เกิดข้อผิดพลาดในการโหลดข้อมูล กรุณาลองใหม่อีกครั้ง"}])}},T=e=>{switch(e){case"vip":return(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"VIP"});case"active":return(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Active"});case"inactive":return(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Inactive"});default:return(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e})}};return g?(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):b?(0,l.jsxs)("div",{className:"text-center text-red-600 py-8",children:[(0,l.jsxs)("p",{children:["เกิดข้อผิดพลาด: ",b]}),(0,l.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"ลองใหม่"})]}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-semibold",children:"ประวัติลูกค้า"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"ข้อมูลลูกค้าและการใช้งานบริการ"})]}),(0,l.jsxs)("select",{value:j,onChange:e=>{p(e.target.value)},className:"px-3 py-2 border rounded-md text-sm",children:[(0,l.jsx)("option",{value:"all",children:"ทั้งหมด"}),(0,l.jsx)("option",{value:"active",children:"Active"}),(0,l.jsx)("option",{value:"vip",children:"VIP"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium",children:"ลูกค้าทั้งหมด"}),(0,l.jsx)(v.A,{className:"h-4 w-4 text-blue-600"})]}),(0,l.jsxs)(o,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:(null==h||null==(e=h.totalCustomers)?void 0:e.toLocaleString())||"0"}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"รายชื่อ"})]})]}),(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium",children:"ลูกค้า Active"}),(0,l.jsx)(q,{className:"h-4 w-4 text-green-600"})]}),(0,l.jsxs)(o,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-green-600",children:(null==h||null==(t=h.activeCustomers)?void 0:t.toLocaleString())||"0"}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"รายชื่อ"})]})]}),(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium",children:"ลูกค้า VIP"}),(0,l.jsx)(q,{className:"h-4 w-4 text-yellow-600"})]}),(0,l.jsxs)(o,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:(null==h||null==(s=h.vipCustomers)?void 0:s.toLocaleString())||"0"}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"รายชื่อ"})]})]}),(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium",children:"รายได้รวม"}),(0,l.jsx)(N.A,{className:"h-4 w-4 text-purple-600"})]}),(0,l.jsxs)(o,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:["฿",(null==h||null==(r=h.totalRevenue)?void 0:r.toLocaleString())||"0"]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"รวมรายได้"})]})]})]}),(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{children:[(0,l.jsxs)(d,{className:"flex items-center space-x-2",children:[(0,l.jsx)(v.A,{className:"w-5 h-5"}),(0,l.jsx)("span",{children:"รายชื่อลูกค้า"})]}),(0,l.jsx)(x,{children:"คลิกที่รายชื่อลูกค้าเพื่อดูรายละเอียดการทำงาน"})]}),(0,l.jsx)(o,{className:"p-0",children:(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-gray-50 border-b border-gray-200",children:[(0,l.jsx)("th",{className:"text-left px-6 py-4 font-semibold text-gray-700",children:"ลูกค้า"}),(0,l.jsx)("th",{className:"text-left px-6 py-4 font-semibold text-gray-700",children:"รถยนต์"}),(0,l.jsx)("th",{className:"text-left px-6 py-4 font-semibold text-gray-700",children:"ติดต่อ"}),(0,l.jsx)("th",{className:"text-center px-6 py-4 font-semibold text-gray-700",children:"งาน"}),(0,l.jsx)("th",{className:"text-right px-6 py-4 font-semibold text-gray-700",children:"ยอดใช้จ่าย"}),(0,l.jsx)("th",{className:"text-left px-6 py-4 font-semibold text-gray-700",children:"บริการที่ใช้"}),(0,l.jsx)("th",{className:"text-center px-6 py-4 font-semibold text-gray-700",children:"สถานะ"})]})}),(0,l.jsx)("tbody",{className:"divide-y divide-gray-100",children:n.map(e=>{var t,s;return(0,l.jsxs)("tr",{className:"hover:bg-blue-50 cursor-pointer transition-all duration-200 hover:shadow-sm",onClick:()=>P(e),children:[(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-semibold text-gray-900",children:e.customerName}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:(t=e.totalSpent,s=e.totalJobs,t>=1e5||s>=20?"VIP":t>=5e4||s>=10?"Regular":t>=1e4||s>=5?"Occasional":"New")})]})}),(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-medium text-gray-900",children:e.carType}),(0,l.jsx)("div",{className:"text-sm text-gray-600 font-mono",children:e.licensePlate})]})}),(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsx)("div",{className:"text-sm text-gray-900",children:e.phoneNumber})}),(0,l.jsx)("td",{className:"px-6 py-4 text-center",children:(0,l.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:e.totalJobs})}),(0,l.jsx)("td",{className:"px-6 py-4 text-right",children:(0,l.jsxs)("div",{className:"font-semibold text-lg text-green-600",children:["฿",e.totalSpent.toLocaleString()]})}),(0,l.jsx)("td",{className:"px-6 py-4",children:(0,l.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.favoriteServices.slice(0,2).map((t,s)=>(0,l.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium ".concat("ยังไม่เคยใช้บริการ"===t?"bg-amber-100 text-amber-800":"bg-gray-100 text-gray-700"),children:t},"".concat(e.id,"-service-").concat(s))),e.favoriteServices.length>2&&(0,l.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-700",children:["+",e.favoriteServices.length-2]},"".concat(e.id,"-service-more"))]})}),(0,l.jsx)("td",{className:"px-6 py-4 text-center",children:T(e.status)})]},e.id)})})]})})})]}),C&&S&&(0,l.jsx)("div",{className:"fixed inset-0 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl max-w-5xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-8 border-b border-gray-100 bg-gradient-to-r from-blue-50 to-indigo-50",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:S.customerName}),(0,l.jsx)("p",{className:"text-gray-600 mt-2 text-lg",children:"ประวัติการใช้งานบริการและรายละเอียดงาน"})]}),(0,l.jsx)("button",{onClick:()=>M(!1),className:"p-3 hover:bg-white hover:bg-opacity-50 rounded-full transition-all duration-200",children:(0,l.jsx)(H.A,{className:"w-6 h-6 text-gray-600"})})]}),(0,l.jsxs)("div",{className:"p-8 border-b bg-gradient-to-r from-gray-50 to-blue-50",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(I.A,{className:"w-5 h-5 text-blue-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"รถยนต์"}),(0,l.jsx)("p",{className:"font-medium",children:S.carType})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(y.A,{className:"w-5 h-5 text-green-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"ทะเบียน"}),(0,l.jsx)("p",{className:"font-medium",children:S.licensePlate})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(v.A,{className:"w-5 h-5 text-purple-600"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"สถานะ"}),(0,l.jsx)("div",{className:"mt-1",children:T(S.status)})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-8",children:[(0,l.jsxs)("div",{className:"text-center p-6 bg-white rounded-xl shadow-sm border border-blue-100",children:[(0,l.jsx)("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:S.totalJobs}),(0,l.jsx)("div",{className:"text-sm text-gray-600 font-medium",children:"งานทั้งหมด"})]}),(0,l.jsxs)("div",{className:"text-center p-6 bg-white rounded-xl shadow-sm border border-green-100",children:[(0,l.jsxs)("div",{className:"text-3xl font-bold text-green-600 mb-2",children:["฿",S.totalSpent.toLocaleString()]}),(0,l.jsx)("div",{className:"text-sm text-gray-600 font-medium",children:"ใช้จ่ายรวม"})]}),(0,l.jsxs)("div",{className:"text-center p-6 bg-white rounded-xl shadow-sm border border-purple-100",children:[(0,l.jsxs)("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:["฿",S.totalJobs>0?Math.round(S.totalSpent/S.totalJobs).toLocaleString():"0"]}),(0,l.jsx)("div",{className:"text-sm text-gray-600 font-medium",children:"เฉลี่ยต่องาน"})]})]})]}),(0,l.jsxs)("div",{className:"p-8",children:[(0,l.jsxs)("h3",{className:"text-2xl font-bold mb-6 flex items-center space-x-3 text-gray-800",children:[(0,l.jsx)(F.A,{className:"w-6 h-6 text-indigo-600"}),(0,l.jsx)("span",{children:"ประวัติการทำงาน"})]}),0===S.totalJobs?(0,l.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,l.jsx)(F.A,{className:"w-20 h-20 mx-auto mb-6 text-gray-300"}),(0,l.jsx)("p",{className:"text-xl font-medium text-gray-600",children:"ยังไม่เคยใช้บริการ"}),(0,l.jsx)("p",{className:"text-gray-500 mt-2",children:"ลูกค้าคนนี้ยังไม่เคยใช้บริการในระบบ"})]}):(0,l.jsx)("div",{className:"space-y-6",children:R.map(e=>{var t,s,a,r;return(0,l.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all duration-200",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:e.jobNumber}),(0,l.jsx)("span",{className:"text-sm text-gray-500",children:e.date})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat((e=>{switch(e.toLowerCase()){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";case"pending":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}})(e.status)),children:"completed"===e.status||"COMPLETED"===e.status?"เสร็จสิ้น":"in_progress"===e.status||"IN_PROGRESS"===e.status?"กำลังดำเนินการ":"cancelled"===e.status||"CANCELLED"===e.status?"ยกเลิก":"pending"===e.status||"PENDING"===e.status?"รอดำเนินการ":e.status}),(0,l.jsxs)("span",{className:"font-bold text-green-600",children:["฿",S.totalSpent.toLocaleString()]})]})]}),(0,l.jsx)("h4",{className:"font-medium mb-2",children:e.serviceType}),(0,l.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 mb-3 border-l-4 border-blue-400",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-gray-600",children:"สินค้า:"}),(0,l.jsxs)("span",{className:"font-medium ml-2",children:["฿",(null==(t=e.subtotal)?void 0:t.toLocaleString())||"0"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-gray-600",children:"ค่าแรง:"}),(0,l.jsxs)("span",{className:"font-medium ml-2",children:["฿",(null==(s=e.laborCost)?void 0:s.toLocaleString())||"0"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-gray-600",children:"ภาษี:"}),(0,l.jsxs)("span",{className:"font-medium ml-2",children:["฿",(null==(a=e.vatAmount)?void 0:a.toLocaleString())||"0"]})]}),(0,l.jsxs)("div",{className:"font-bold text-blue-700",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"รวม:"}),(0,l.jsxs)("span",{className:"ml-2",children:["฿",(null==(r=e.grandTotal)?void 0:r.toLocaleString())||e.totalAmount.toLocaleString()]})]})]}),!e.subtotal&&!e.laborCost&&!e.vatAmount&&(0,l.jsx)("div",{className:"text-xs text-gray-500 mt-2 text-center",children:"ข้อมูลการเงินยังไม่ถูกบันทึก"})]}),e.notes&&(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:e.notes}),(0,l.jsxs)("div",{className:"bg-gray-50 rounded p-3",children:[(0,l.jsxs)("h5",{className:"text-sm font-medium mb-2 flex items-center space-x-2",children:[(0,l.jsx)(w.A,{className:"w-4 h-4"}),(0,l.jsx)("span",{children:"รายการสินค้า"})]}),(0,l.jsx)("div",{className:"space-y-2",children:e.items.map((e,t)=>(0,l.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,l.jsx)("span",{children:e.productName}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("span",{className:"text-gray-500",children:[e.qty," x ฿",e.unitPrice.toLocaleString()]}),(0,l.jsxs)("span",{className:"font-medium",children:["฿",e.totalPrice.toLocaleString()]})]})]},t))})]})]},e.id)})})]})]})})]})}function W(){var e,t;let[s,n]=(0,a.useState)("low-stock"),[m,p]=(0,a.useState)(null),[k,C]=(0,a.useState)(!0),[M,R]=(0,a.useState)(null),E=(0,r.useRouter)();return((0,a.useEffect)(()=>{(async()=>{try{R(null);let e=await L.getReportsSummary();p(e)}catch(e){if(console.error("Failed to fetch reports summary:",e),"Authentication required"===e.message)return void E.push("/login");R(e.message||"Failed to fetch reports summary")}finally{C(!1)}})()},[E]),k)?(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):M?(0,l.jsx)("div",{className:"container mx-auto p-6",children:(0,l.jsxs)("div",{className:"text-center text-red-600",children:[(0,l.jsx)(f.A,{className:"w-12 h-12 mx-auto mb-4"}),(0,l.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"เกิดข้อผิดพลาด"}),(0,l.jsx)("p",{children:M}),(0,l.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"ลองใหม่"})]})}):(0,l.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"รายงานระบบ"}),(0,l.jsx)("p",{className:"text-gray-600 mt-2",children:"ดูข้อมูลสถิติและรายงานต่างๆ ของระบบ"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-gray-500",children:[(0,l.jsx)(y.A,{className:"w-6 h-6"}),(0,l.jsx)("span",{className:"text-sm",children:"Reports Dashboard"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,l.jsxs)(c,{className:"border-l-4 border-l-orange-500 bg-gradient-to-r from-orange-50 to-white",children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium text-orange-600",children:"รายได้วันนี้"}),(0,l.jsx)(N.A,{className:"h-4 w-4 text-orange-500"})]}),(0,l.jsxs)(o,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold text-orange-600",children:["฿",(null==m||null==(e=m.todayRevenue)?void 0:e.toLocaleString())||"0"]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"รวมรายได้วันนี้"})]})]}),(0,l.jsxs)(c,{className:"border-l-4 border-l-emerald-500 bg-gradient-to-r from-emerald-50 to-white",children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium text-emerald-600",children:"งานวันนี้"}),(0,l.jsx)(b.A,{className:"h-4 w-4 text-emerald-500"})]}),(0,l.jsxs)(o,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-emerald-600",children:(null==m?void 0:m.todayJobs)||0}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"จำนวนงานที่เสร็จสิ้น"})]})]}),(0,l.jsxs)(c,{className:"border-l-4 border-l-indigo-500 bg-gradient-to-r from-indigo-50 to-white",children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium text-indigo-600",children:"ลูกค้าใหม่"}),(0,l.jsx)(v.A,{className:"h-4 w-4 text-indigo-500"})]}),(0,l.jsxs)(o,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-indigo-600",children:(null==m?void 0:m.todayNewCustomers)||0}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"ลูกค้าใหม่วันนี้"})]})]}),(0,l.jsxs)(c,{className:"border-l-4 border-l-rose-500 bg-gradient-to-r from-rose-50 to-white",children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium text-rose-600",children:"สินค้าขาย"}),(0,l.jsx)(w.A,{className:"h-4 w-4 text-rose-500"})]}),(0,l.jsxs)(o,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-rose-600",children:(null==m?void 0:m.todayProductsSold)||0}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"จำนวนสินค้าที่ขาย"})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,l.jsxs)(c,{className:"border-l-4 border-l-red-500",children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium text-red-600",children:"สินค้าใกล้หมด"}),(0,l.jsx)(f.A,{className:"h-4 w-4 text-red-500"})]}),(0,l.jsxs)(o,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-red-600",children:(null==m?void 0:m.lowStockCount)||0}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"รายการ"})]})]}),(0,l.jsxs)(c,{className:"border-l-4 border-l-blue-500",children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium text-blue-600",children:"มูลค่าสินค้า"}),(0,l.jsx)(N.A,{className:"h-4 w-4 text-blue-500"})]}),(0,l.jsxs)(o,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:["฿",(null==m||null==(t=m.totalInventoryValue)?void 0:t.toLocaleString())||"0"]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"รวมมูลค่า"})]})]}),(0,l.jsxs)(c,{className:"border-l-4 border-l-green-500",children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium text-green-600",children:"สินค้าขายดี"}),(0,l.jsx)(A.A,{className:"h-4 w-4 text-green-500"})]}),(0,l.jsxs)(o,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-green-600",children:(null==m?void 0:m.topMovingCount)||0}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"รายการ"})]})]}),(0,l.jsxs)(c,{className:"border-l-4 border-l-purple-500",children:[(0,l.jsxs)(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(d,{className:"text-sm font-medium text-purple-600",children:"ลูกค้าทั้งหมด"}),(0,l.jsx)(v.A,{className:"h-4 w-4 text-purple-500"})]}),(0,l.jsxs)(o,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:(null==m?void 0:m.customerCount)||0}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"รายชื่อ"})]})]})]}),(0,l.jsxs)(c,{children:[(0,l.jsxs)(i,{children:[(0,l.jsxs)(d,{className:"flex items-center space-x-2",children:[(0,l.jsx)(S.A,{className:"w-5 h-5"}),(0,l.jsx)("span",{children:"รายงานรายละเอียด"})]}),(0,l.jsx)(x,{children:"เลือกประเภทรายงานที่ต้องการดู"})]}),(0,l.jsx)(o,{children:(0,l.jsxs)(g,{value:s,onValueChange:n,className:"w-full",children:[(0,l.jsxs)(h,{className:"grid w-full grid-cols-4",children:[(0,l.jsxs)(u,{value:"low-stock",className:"flex items-center space-x-2",children:[(0,l.jsx)(f.A,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"สินค้าใกล้หมด"})]}),(0,l.jsxs)(u,{value:"inventory-value",className:"flex items-center space-x-2",children:[(0,l.jsx)(N.A,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"มูลค่าสินค้า"})]}),(0,l.jsxs)(u,{value:"top-moving",className:"flex items-center space-x-2",children:[(0,l.jsx)(A.A,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"สินค้าขายดี"})]}),(0,l.jsxs)(u,{value:"customer-history",className:"flex items-center space-x-2",children:[(0,l.jsx)(v.A,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"ประวัติลูกค้า"})]})]}),(0,l.jsx)(j,{value:"low-stock",className:"mt-6",children:(0,l.jsx)(P,{})}),(0,l.jsx)(j,{value:"inventory-value",className:"mt-6",children:(0,l.jsx)(T,{})}),(0,l.jsx)(j,{value:"top-moving",className:"mt-6",children:(0,l.jsx)(V,{})}),(0,l.jsx)(j,{value:"customer-history",className:"mt-6",children:(0,l.jsx)(J,{})})]})})]})]})}},9946:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var l=s(2115);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},r=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,l.forwardRef)((e,t)=>{let{color:s="currentColor",size:a=24,strokeWidth:c=2,absoluteStrokeWidth:i,className:d="",children:x,iconNode:o,...m}=e;return(0,l.createElement)("svg",{ref:t,...n,width:a,height:a,stroke:s,strokeWidth:i?24*Number(c)/Number(a):c,className:r("lucide",d),...!x&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"},...m},[...o.map(e=>{let[t,s]=e;return(0,l.createElement)(t,s)}),...Array.isArray(x)?x:[x]])}),i=(e,t)=>{let s=(0,l.forwardRef)((s,n)=>{let{className:i,...d}=s;return(0,l.createElement)(c,{ref:n,iconNode:t,className:r("lucide-".concat(a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),i),...d})});return s.displayName=a(e),s}}},e=>{e.O(0,[441,964,358],()=>e(e.s=7587)),_N_E=e.O()}]);