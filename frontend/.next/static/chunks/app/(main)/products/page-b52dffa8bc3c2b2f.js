(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[248],{283:(e,t,s)=>{"use strict";s.d(t,{A:()=>i,AuthProvider:()=>c});var r=s(5155),a=s(2115),l=s(5695);let n=(0,a.createContext)(void 0),i=()=>{let e=(0,a.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},c=e=>{let{children:t}=e,[s,i]=(0,a.useState)(null),[c,o]=(0,a.useState)(!0),d=(0,l.useRouter)(),x=async()=>{try{let e=await fetch("".concat("http://localhost:5001","/auth/me"),{credentials:"include"});if(e.ok){let t=await e.json();i(t.user)}else i(null)}catch(e){console.error("Auth check failed:",e),i(null)}finally{o(!1)}},u=async(e,t,s)=>{let r=await fetch("".concat("http://localhost:5001","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:e,password:t,rememberMe:s})});if(!r.ok)throw Error((await r.json()).message||"Login failed");i((await r.json()).user),d.push("/dashboard")},m=async()=>{try{await fetch("".concat("http://localhost:5001","/auth/logout"),{method:"POST",credentials:"include"})}catch(e){console.error("Logout failed:",e)}finally{i(null),d.push("/login")}};return(0,a.useEffect)(()=>{x()},[]),(0,r.jsx)(n.Provider,{value:{user:s,loading:c,login:u,logout:m,checkAuth:x},children:t})}},646:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(9946).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},2525:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(9946).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},3717:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(9946).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},4416:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(9946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},4965:(e,t,s)=>{Promise.resolve().then(s.bind(s,9679))},5695:(e,t,s)=>{"use strict";var r=s(8999);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},5868:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(9946).A)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},6440:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var r=s(5155),a=s(2115),l=s(4416);function n(e){let{open:t,title:s,onClose:n,children:i,size:c="md"}=e;return((0,a.useEffect)(()=>{function e(e){"Escape"===e.key&&n()}return t&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[t,n]),t)?(0,r.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-300",onClick:n}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"w-full ".concat({sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-7xl"}[c]," bg-white rounded-2xl shadow-2xl border border-gray-200 transform transition-all duration-300 scale-100 opacity-100"),style:{maxHeight:"90vh",overflow:"hidden"},children:[s&&(0,r.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-white",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:s}),(0,r.jsx)("button",{onClick:n,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:(0,r.jsx)(l.A,{size:20})})]}),(0,r.jsx)("div",{className:"overflow-y-auto",style:{maxHeight:"calc(90vh - 80px)"},children:i})]})})]}):null}},7108:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(9946).A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},8293:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(9946).A)("box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},9679:(e,t,s)=>{"use strict";s.d(t,{default:()=>y});var r=s(5155),a=s(2115),l=s(283),n=s(6440),i=s(7108),c=s(9946);let o=(0,c.A)("barcode",[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M8 5v14",key:"1ybrkv"}],["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"M17 5v14",key:"ycjyhj"}],["path",{d:"M21 5v14",key:"nzette"}]]),d=(0,c.A)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var x=s(5868),u=s(8293),m=s(646);function h(e){var t,s,l,n,c,h,g,p,y,f,b,j;let{mode:v,initial:N,onSubmit:w,onCancel:k}=e,[S,A]=(0,a.useState)([]),[C,E]=(0,a.useState)(!1),[P,L]=(0,a.useState)(null),[M,I]=(0,a.useState)(!1),[z,U]=(0,a.useState)(null),[q,R]=(0,a.useState)({sku:null!=(l=null==N?void 0:N.sku)?l:"",barcode:null!=(n=null==N?void 0:N.barcode)?n:"",name:null!=(c=null==N?void 0:N.name)?c:"",description:null!=(h=null==N?void 0:N.description)?h:"",categoryId:null!=(g=null==N?void 0:N.categoryId)?g:null,costPrice:null!=(p=null==N?void 0:N.costPrice)?p:0,sellPrice:null!=(y=null==N?void 0:N.sellPrice)?y:0,minStockLevel:null!=(f=null==N?void 0:N.minStockLevel)?f:1,branchId:null!=(b=null==N?void 0:N.branchId)?b:1,stockQuantity:null!=(j=null==N?void 0:N.stockQuantity)?j:0});(0,a.useEffect)(()=>{!async function(){try{var e;let t=await fetch("".concat("http://localhost:5001","/categories"),{credentials:"include"});if(!t.ok)throw Error("Failed to fetch categories");let s=await t.json();A(null!=(e=s.items)?e:[])}catch(e){console.error("Error loading categories:",e)}}()},[]),(0,a.useEffect)(()=>{if(N&&"edit"===v){var e,t,s,r,a,l,n,i,c,o;R({sku:null!=(e=N.sku)?e:"",barcode:null!=(t=N.barcode)?t:"",name:null!=(s=N.name)?s:"",description:null!=(r=N.description)?r:"",categoryId:null!=(a=N.categoryId)?a:null,costPrice:null!=(l=N.costPrice)?l:0,sellPrice:null!=(n=N.sellPrice)?n:0,minStockLevel:null!=(i=N.minStockLevel)?i:1,branchId:null!=(c=N.branchId)?c:1,stockQuantity:null!=(o=N.stockQuantity)?o:0})}},[N,v]);let[F,O]=(0,a.useState)(null);async function Q(e){e.preventDefault(),L(null),U(q),I(!0)}async function K(){if(z){E(!0),L(null);try{await w(z),I(!1),U(null)}catch(e){L((null==e?void 0:e.message)||"Submit failed")}finally{E(!1)}}}return(0,a.useEffect)(()=>{async function e(e){try{var t;let s=await fetch("".concat("http://localhost:5001","/products/next-sku?prefix=").concat(encodeURIComponent(e)),{credentials:"include"});if(!s.ok)throw Error("Failed to fetch next SKU");let r=await s.json();O(null!=(t=null==r?void 0:r.nextSku)?t:null)}catch(e){console.error("Error loading next SKU:",e),O(null)}}let t=q.sku.trim();"create"===v&&/^[A-Za-z0-9]{1,6}$/.test(t)?e(t):O(null)},[q.sku,v]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("form",{onSubmit:Q,className:"p-6 space-y-8",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 pb-4 border-b border-gray-200",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)(i.A,{className:"w-4 h-4 text-blue-600"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"ข้อมูลพื้นฐาน"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["SKU ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",required:!0,className:"w-full px-4 py-3 border text-gray-700 border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all duration-200 shadow-sm",placeholder:"เช่น ABC001",value:q.sku,onChange:e=>R({...q,sku:e.target.value}),maxLength:10}),F&&(0,r.jsx)("div",{className:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded-lg",children:(0,r.jsxs)("p",{className:"text-sm text-blue-700",children:["SKU ถัดไป:"," ",(0,r.jsx)("span",{className:"font-semibold",children:F})]})})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Barcode"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:(0,r.jsx)(o,{className:"w-4 h-4"})}),(0,r.jsx)("input",{type:"text",className:"w-full pl-10 pr-4 py-3 border text-gray-700 border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all duration-200 shadow-sm",placeholder:"1234567890123",value:q.barcode,onChange:e=>R({...q,barcode:e.target.value}),maxLength:20})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["ชื่อสินค้า ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{type:"text",required:!0,className:"w-full px-4 py-3 border text-gray-700 border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all duration-200 shadow-sm",placeholder:"ชื่อสินค้า",value:q.name,onChange:e=>R({...q,name:e.target.value})})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"คำอธิบาย"}),(0,r.jsx)("textarea",{rows:3,className:"w-full px-4 py-3 border text-gray-700 border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all duration-200 shadow-sm resize-none",placeholder:"รายละเอียดสินค้า...",value:q.description,onChange:e=>R({...q,description:e.target.value})})]})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 pb-4 border-b border-gray-200",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)(d,{className:"w-4 h-4 text-green-600"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"หมวดหมู่และสาขา"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["หมวดหมู่ ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("select",{required:!0,className:"w-full px-4 py-3 border text-gray-700 border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all duration-200 shadow-sm",value:q.categoryId||"",onChange:e=>R({...q,categoryId:e.target.value?Number(e.target.value):null}),children:[(0,r.jsx)("option",{value:"",children:"เลือกหมวดหมู่"}),S.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["สาขา ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("select",{required:!0,className:"w-full px-4 py-3 border text-gray-700 border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all duration-200 shadow-sm",value:q.branchId,onChange:e=>R({...q,branchId:Number(e.target.value)}),children:(0,r.jsx)("option",{value:1,children:"Main Branch"})})]})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 pb-4 border-b border-gray-200",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)(x.A,{className:"w-4 h-4 text-yellow-600"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"ราคาและต้นทุน"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["ต้นทุน (บาท) ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"฿"}),(0,r.jsx)("input",{type:"number",required:!0,min:"0",step:"0.01",className:"w-full pl-8 pr-4 py-3 border text-gray-700 border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all duration-200 shadow-sm",placeholder:"0.00",value:q.costPrice,onChange:e=>R({...q,costPrice:Number(e.target.value)})})]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["ราคาขาย (บาท) ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"฿"}),(0,r.jsx)("input",{type:"text",required:!0,min:"0",step:"0.01",className:"w-full pl-8 pr-4 py-3 border text-gray-700 border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all duration-200 shadow-sm",placeholder:"0.00",value:q.sellPrice,onChange:e=>R({...q,sellPrice:Number(e.target.value)})})]})]})]})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 pb-4 border-b border-gray-200",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)(u.A,{className:"w-4 h-4 text-purple-600"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"การจัดการสต็อก"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"จำนวนคงเหลือ"}),(0,r.jsx)("input",{type:"number",min:"0",className:"w-full px-4 py-3 border text-gray-700 border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all duration-200 shadow-sm",placeholder:"0",value:q.stockQuantity,onChange:e=>R({...q,stockQuantity:Number(e.target.value)})})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"ระดับสต็อกต่ำสุด"}),(0,r.jsx)("input",{type:"number",min:"0",className:"w-full px-4 py-3 border text-gray-700 border-gray-300 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all duration-200 shadow-sm",placeholder:"1",value:q.minStockLevel,onChange:e=>R({...q,minStockLevel:Number(e.target.value)})})]})]})]}),P&&(0,r.jsx)("div",{className:"rounded-xl bg-red-50 p-4 border border-red-200",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-5 h-5 bg-red-100 rounded-full flex items-center justify-center",children:(0,r.jsx)("div",{className:"w-3 h-3 bg-red-600 rounded-full"})}),(0,r.jsx)("p",{className:"text-sm text-red-700",children:P})]})}),(0,r.jsxs)("div",{className:"flex items-center justify-end gap-4 pt-6 border-t border-gray-200",children:[(0,r.jsx)("button",{type:"button",onClick:k,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 font-medium",children:"ยกเลิก"}),(0,r.jsx)("button",{type:"submit",disabled:C,className:"px-6 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-xl hover:from-orange-600 hover:to-orange-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium flex items-center gap-3 shadow-lg",children:C?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"กำลังบันทึก..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.A,{className:"w-5 h-5"}),"create"===v?"เพิ่มสินค้า":"บันทึกการแก้ไข"]})})]})]}),M&&(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>I(!1)}),(0,r.jsxs)("div",{className:"relative bg-white rounded-2xl shadow-2xl border border-gray-200 p-6 w-full max-w-md mx-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:(0,r.jsx)(m.A,{className:"w-5 h-5 text-orange-600"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"ยืนยันการแก้ไข"})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("p",{className:"text-gray-600 mb-4",children:["คุณต้องการบันทึกการแก้ไขสินค้า"," ",(0,r.jsx)("span",{className:"font-semibold text-gray-900",children:null==z?void 0:z.name})," ","หรือไม่?"]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"SKU:"}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900",children:null==z?void 0:z.sku})]}),(null==z?void 0:z.barcode)&&(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"Barcode:"}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900",children:z.barcode})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"หมวดหมู่:"}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900",children:(null==(t=S.find(e=>e.id===(null==z?void 0:z.categoryId)))?void 0:t.name)||"ไม่ระบุ"})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"ราคาขาย:"}),(0,r.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["฿",null==z||null==(s=z.sellPrice)?void 0:s.toFixed(2)]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>I(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors font-medium",children:"ยกเลิก"}),(0,r.jsx)("button",{type:"button",onClick:K,disabled:C,className:"px-4 py-2 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-lg hover:from-orange-600 hover:to-orange-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium flex items-center gap-2",children:C?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"กำลังบันทึก..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.A,{className:"w-4 h-4"}),"ยืนยัน"]})})]})]})]})]})}var g=s(3717),p=s(2525);function y(){var e,t,s;let{user:i}=(0,l.A)(),[c,o]=(0,a.useState)([]),[d,x]=(0,a.useState)([]),[u,m]=(0,a.useState)(!1),[y,f]=(0,a.useState)(""),[b,j]=(0,a.useState)(""),[v,N]=(0,a.useState)(0),[w,k]=(0,a.useState)(!1),[S,A]=(0,a.useState)(null),[C,E]=(0,a.useState)(null);async function P(){try{var e;let t=await fetch("".concat("http://localhost:5001","/categories"),{credentials:"include"});if(!t.ok)throw Error("Failed to fetch categories");let s=await t.json();x(null!=(e=s.items)?e:[])}catch(e){console.error("Error fetching categories:",e)}}async function L(){try{var e,t;m(!0);let s=new URLSearchParams;y&&s.set("q",y),b&&s.set("categoryId",b),s.set("page","1"),s.set("pageSize","20");let r=await fetch("".concat("http://localhost:5001","/products?").concat(s.toString()),{credentials:"include"});if(!r.ok)throw Error("Failed to fetch products");let a=await r.json();o(null!=(e=a.items)?e:[]),N(null!=(t=a.total)?t:0)}catch(e){console.error("Error fetching products:",e)}finally{m(!1)}}async function M(e){try{let t=await fetch("".concat("http://localhost:5001","/products"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){let e=await t.json();throw Error(e.message||"Create failed")}k(!1),await L()}catch(e){console.error("Error creating product:",e),alert(e instanceof Error?e.message:"Create failed")}}async function I(e,t){try{let s=await fetch("".concat("http://localhost:5001","/products/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});if(!s.ok){let e=await s.json();throw Error(e.message||"Update failed")}A(null),await L()}catch(e){console.error("Error updating product:",e),alert(e instanceof Error?e.message:"Update failed")}}async function z(e){try{let t=await fetch("".concat("http://localhost:5001","/products/").concat(e),{method:"DELETE",credentials:"include"});if(!t.ok){let e=await t.json();throw Error(e.message||"Delete failed")}E(null),await L()}catch(e){console.error("Error deleting product:",e),alert(e instanceof Error?e.message:"Delete failed")}}return(0,a.useEffect)(()=>{P()},[]),(0,a.useEffect)(()=>{L()},[y,b]),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"จัดการสินค้า"}),(0,r.jsx)("p",{className:"text-gray-600",children:"ค้นหา แก้ไข และจัดการข้อมูลสินค้าทั้งหมด"})]}),(0,r.jsx)("div",{className:"mt-4 lg:mt-0",children:(0,r.jsxs)("button",{className:"px-6 py-3 bg-orange-600 text-white rounded-xl hover:bg-orange-700 transition-colors font-medium flex items-center gap-2",onClick:()=>k(!0),children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"เพิ่มสินค้าใหม่"]})})]})}),(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ค้นหาสินค้า"}),(0,r.jsx)("input",{className:"w-full px-4 py-3 border border-gray-300 text-gray-900 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors",placeholder:"ค้นหาจากชื่อ, SKU หรือคำอธิบาย...",value:y,onChange:e=>f(e.target.value)})]}),(0,r.jsxs)("div",{className:"lg:w-64",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"หมวดหมู่"}),(0,r.jsxs)("select",{className:"w-full px-4 py-3 border border-gray-300 text-gray-900 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors",value:b,onChange:e=>j(e.target.value),children:[(0,r.jsx)("option",{value:"",children:"ทุกหมวดหมู่"}),d.map(e=>(0,r.jsx)("option",{value:String(e.id),children:e.name},e.id))]})]})]})}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50 border-b border-gray-200",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SKU"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ชื่อสินค้า"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"หมวดหมู่"}),(null==i?void 0:i.role)==="OWNER"&&(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ต้นทุน"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"จำนวนคงเหลือ"}),(0,r.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ราคาขาย"}),(0,r.jsx)("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"การดำเนินการ"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:u?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:7,className:"px-6 py-12 text-center",children:(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600"}),(0,r.jsx)("span",{className:"ml-3 text-gray-500",children:"กำลังโหลดข้อมูล..."})]})})}):0===c.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"ไม่พบข้อมูลสินค้า"})}):c.map(e=>{var t,s;return(0,r.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:e.sku})}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),e.description&&(0,r.jsx)("div",{className:"text-sm text-gray-500 truncate max-w-xs",children:e.description})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:null!=(s=null==(t=e.category)?void 0:t.name)?s:"-"})}),(null==i?void 0:i.role)==="OWNER"&&(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["฿","number"==typeof e.costPrice?e.costPrice.toFixed(2):"-"]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"text-sm font-medium ".concat(e.stockQuantity<=(e.minStockLevel||0)?"text-red-600":"text-gray-900"),children:e.stockQuantity.toLocaleString()}),e.stockQuantity<=(e.minStockLevel||0)&&(0,r.jsx)("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"ต่ำ"})]})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["฿",e.sellPrice.toFixed(2)]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(null==i?void 0:i.role)!=="WORKER"&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>A(e),className:"text-orange-600 hover:text-orange-900 p-2 rounded-lg hover:bg-orange-50 transition-colors",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)(g.A,{})})}),(0,r.jsx)("button",{onClick:()=>E(e),className:"text-red-600 hover:text-red-900 p-2 rounded-lg hover:bg-red-50 transition-colors",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)(p.A,{})})})]}),(null==i?void 0:i.role)==="WORKER"&&(0,r.jsx)("span",{className:"text-xs text-gray-400 italic",children:"ดูข้อมูลเท่านั้น"})]})})]},e.id)})})]})}),v>20&&(0,r.jsx)("div",{className:"bg-white px-6 py-4 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-700",children:["แสดง ",(0,r.jsx)("span",{className:"font-medium",children:"1"})," ถึง ",(0,r.jsx)("span",{className:"font-medium",children:"20"})," จาก ",(0,r.jsx)("span",{className:"font-medium",children:v})," รายการ"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"ก่อนหน้า"}),(0,r.jsx)("button",{className:"px-3 py-2 text-sm font-medium text-orange-600 bg-orange-50 border border-orange-200 rounded-lg",children:"1"}),(0,r.jsx)("button",{className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"2"}),(0,r.jsx)("button",{className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"ถัดไป"})]})]})})]}),w&&(0,r.jsx)(n.A,{open:w,onClose:()=>k(!1),title:"เพิ่มสินค้าใหม่",size:"xl",children:(0,r.jsx)(h,{mode:"create",onSubmit:M,onCancel:()=>k(!1)})}),S&&(0,r.jsx)(n.A,{open:!!S,onClose:()=>A(null),title:"แก้ไขสินค้า",size:"xl",children:(0,r.jsx)(h,{mode:"edit",initial:{id:S.id,sku:S.sku,barcode:null!=(t=S.barcode)?t:"",name:S.name,description:S.description||void 0,costPrice:S.costPrice,sellPrice:S.sellPrice,minStockLevel:S.minStockLevel,stockQuantity:S.stockQuantity,categoryId:null!=(s=null==(e=S.category)?void 0:e.id)?s:null,branchId:S.branchId},onSubmit:e=>I(S.id,e),onCancel:()=>A(null)})}),C&&(0,r.jsx)(n.A,{open:!!C,onClose:()=>E(null),title:"ยืนยันการลบสินค้า",size:"sm",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("div",{className:"flex justify-center mb-4",children:(0,r.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:(0,r.jsx)(p.A,{className:"w-8 h-8 text-red-600"})})}),(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"คุณแน่ใจหรือไม่?"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["คุณกำลังจะลบสินค้า"," ",(0,r.jsxs)("span",{className:"font-semibold text-gray-900",children:['"',C.name,'"']})]}),(0,r.jsxs)("div",{className:"mt-2 p-3 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-600",children:[(0,r.jsx)("span",{className:"font-medium",children:"SKU:"}),(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:C.sku})]}),C.barcode&&(0,r.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-600 mt-1",children:[(0,r.jsx)("span",{className:"font-medium",children:"Barcode:"}),(0,r.jsx)("span",{className:"font-mono text-xs bg-gray-200 px-2 py-1 rounded",children:C.barcode})]})]}),(0,r.jsx)("p",{className:"text-xs text-red-600 mt-3 font-medium",children:"⚠️ การลบจะไม่สามารถยกเลิกได้ และจะส่งผลต่อข้อมูลสต็อก"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,r.jsx)("button",{onClick:()=>E(null),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"ยกเลิก"}),(0,r.jsxs)("button",{onClick:()=>z(C.id),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors flex items-center gap-2",children:[(0,r.jsx)(p.A,{className:"w-4 h-4"}),"ลบสินค้า"]})]})]})})]})}},9946:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var r=s(2115);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},l=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,r.forwardRef)((e,t)=>{let{color:s="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:c,className:o="",children:d,iconNode:x,...u}=e;return(0,r.createElement)("svg",{ref:t,...n,width:a,height:a,stroke:s,strokeWidth:c?24*Number(i)/Number(a):i,className:l("lucide",o),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(u)&&{"aria-hidden":"true"},...u},[...x.map(e=>{let[t,s]=e;return(0,r.createElement)(t,s)}),...Array.isArray(d)?d:[d]])}),c=(e,t)=>{let s=(0,r.forwardRef)((s,n)=>{let{className:c,...o}=s;return(0,r.createElement)(i,{ref:n,iconNode:t,className:l("lucide-".concat(a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),c),...o})});return s.displayName=a(e),s}}},e=>{e.O(0,[441,964,358],()=>e(e.s=4965)),_N_E=e.O()}]);